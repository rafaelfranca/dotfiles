#!/bin/bash

# Read from stdin (the current target file content)
content=$(cat)

# Check if already configured
if echo "$content" | grep -q "source ~/.zshrc.user\|^\. ~/.zshrc.user"; then
  # Already configured, output unchanged
  echo "$content"
else
  # Append the user config sourcing at the end
  echo "$content"
  cat <<'EOF'

# Source user zshrc configuration managed by chezmoi
# Loaded last to allow user config to override system settings
if [ -f ~/.zshrc.user ]; then
  source ~/.zshrc.user
fi
EOF
fi
